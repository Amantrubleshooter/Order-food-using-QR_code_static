{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>Place Order - Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container my-5">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>Place Order for Customer</h2>
            <a href="{% url 'all_orders' %}" class="btn btn-secondary">Back to Orders</a>
        </div>
        
        <div class="card">
            <div class="card-body">
                <form method="POST">
                    {% csrf_token %}
                    
                    <div class="mb-3">
                        <label class="form-label">Customer Phone Number *</label>
                        <input type="text" name="phone" class="form-control" required 
                               placeholder="Enter 10-digit phone number" 
                               pattern="[0-9]{10}" 
                               id="phoneInput">
                        <small class="text-muted">Used as username</small>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">First Name</label>
                            <input type="text" name="first_name" class="form-control" id="fnameInput">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label">Last Name</label>
                            <input type="text" name="last_name" class="form-control" id="lnameInput">
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="is_takeaway" id="takeaway">
                            <label class="form-check-label" for="takeaway">
                                Take Away Order
                            </label>
                        </div>
                    </div>
                    
                    <div class="mb-3" id="tableDiv">
                        <label class="form-label">Table Number</label>
                        <select name="table_number" class="form-control">
                            <option value="">Select Table</option>
                            {% for table in available_tables %}
                            <option value="{{ table.table_number }}">Table {{ table.table_number }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Special Notes</label>
                        <textarea name="notes" class="form-control" rows="2"></textarea>
                    </div>
                    
                    <button type="submit" class="btn btn-primary">Continue to Select Items</button>
                    <a href="{% url 'all_orders' %}" class="btn btn-secondary">Cancel</a>
                </form>
            </div>
        </div>
        
        {% if recent_customers %}
        <div class="mt-4">
            <h5>Recent Customers (Click to auto-fill)</h5>
            <div class="list-group">
                {% for customer in recent_customers %}
                <button type="button" class="list-group-item list-group-item-action" 
                        onclick="fillCustomer('{{ customer.phone }}', '{{ customer.first_name }}', '{{ customer.last_name }}')">
                    <strong>{{ customer.phone }}</strong> - {{ customer.first_name }} {{ customer.last_name }}
                </button>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>
    
    <script>
        document.getElementById('takeaway').addEventListener('change', function() {
            document.getElementById('tableDiv').style.display = this.checked ? 'none' : 'block';
        });
        
        function fillCustomer(phone, fname, lname) {
            document.getElementById('phoneInput').value = phone;
            document.getElementById('fnameInput').value = fname;
            document.getElementById('lnameInput').value = lname;
        }
    </script>
</body>
</html>